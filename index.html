// OCR من الصورة + العد التنازلي let countdownTimeout; let countdownValue = 3;

function analyzeImageFromUpload() { const imageInput = document.getElementById("imageInput"); const inputText = document.getElementById("inputText"); const countdownMsg = document.getElementById("countdownMsg");

if (!imageInput.files.length) { alert("الرجاء اختيار صورة."); return; }

const file = imageInput.files[0]; const reader = new FileReader(); reader.onload = function () { Tesseract.recognize(reader.result, 'ara', { logger: m => console.log(m) }) .then(({ data: { text } }) => { inputText.value = text.trim(); startCountdownToAnalyze(); }); }; reader.readAsDataURL(file); }

function startCountdownToAnalyze() { const countdownMsg = document.getElementById("countdownMsg"); const inputText = document.getElementById("inputText");

countdownValue = 3; countdownMsg.classList.remove("hidden"); countdownMsg.textContent = سيبدأ التحليل خلال ${countdownValue}...;

clearTimeout(countdownTimeout);

const listener = () => { clearTimeout(countdownTimeout); countdownMsg.classList.add("hidden"); inputText.removeEventListener("input", listener); };

inputText.addEventListener("input", listener);

function tick() { countdownValue--; if (countdownValue > 0) { countdownMsg.textContent = سيبدأ التحليل خلال ${countdownValue}...; countdownTimeout = setTimeout(tick, 1000); } else { countdownMsg.classList.add("hidden"); inputText.removeEventListener("input", listener); analyze(); } }

countdownTimeout = setTimeout(tick, 1000); }

document.getElementById("imageInput").addEventListener("change", analyzeImageFromUpload);

function startApp() { const pass = document.getElementById("passcodeInput").value; if (pass === "2222") { document.getElementById("introScreen").style.display = "none"; document.getElementById("mainApp").style.display = "block"; } else { document.getElementById("errorMessage").textContent = "رمز المرور غير صحيح"; } }

document.getElementById("passcodeInput").addEventListener("keydown", function (event) { if (event.key === "Enter") { event.preventDefault(); startApp(); } });

function toggleDarkMode() { const body = document.getElementById("body"); body.classList.toggle("dark-mode"); localStorage.setItem("dark-mode", body.classList.contains("dark-mode") ? "on" : "off"); }

window.onload = function () { if (localStorage.getItem("dark-mode") === "on") { document.getElementById("body").classList.add("dark-mode"); } };

function openAyah() { const suraInput = document.getElementById("suraName").value.trim(); const aya = document.getElementById("ayaNumber").value.trim(); const sura = parseInt(suraInput) || 0; if (!sura || sura < 1 || sura > 114) { alert("يرجى إدخال اسم أو رقم سورة صحيح"); return; } const url = aya ? https://quran.com/${sura}/${aya} : https://quran.com/${sura}; window.open(url, "_blank"); } </script>

<div class="text-center text-sm text-gray-600 mt-16 mb-4 leading-relaxed">
  <p class="text-green-700 font-semibold">﴿ وَقُل رَّبِّ زِدْنِي عِلْمًا ﴾</p>
  <p>تم بحمد الله وتوفيقه</p>
  <p>بإشراف: <strong>عبدالرحمن عمرو</strong></p>
  <p>تطوير: <strong>حسن علي</strong></p>
</div></body>
</html>
